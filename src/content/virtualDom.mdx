import { CodeBlock } from "../components/CodeBlock";
import Box from "../components/Box.jsx"

# VirtualDOM
DOM - это сокращение от "Document Object Model" (объектная модель документа). Когда ты открываешь веб-страницу в браузере, браузер создает структуру документа, которую можно представить в виде дерева элементов. Эти элементы - это HTML-теги, например, `<div>`, `<p>`, `<h1>` и другие. DOM позволяет нам манипулировать этой структурой, изменять содержимое, стили, добавлять и удалять элементы.

Виртуальный DOM - это промежуточное представление DOM в памяти компьютера. React создает виртуальное дерево элементов, которое точно соответствует текущему состоянию компонентов. Затем React сравнивает это виртуальное дерево с реальным DOM и определяет, какие изменения необходимо внести.

**Почему это важно?**

1. **Эффективность** – React обновляет только изменённые элементы, снижая нагрузку на браузер и ускоряя рендер.

2. **Удобство** – Ты работаешь с компонентами, а React сам оптимизирует обновления.

3. **Переносимость** – React одинаково работает во всех браузерах, избавляя от проблем совместимости.

### Reconciliation

**Reconciliation** – это процесс, при котором React сравнивает предыдущее и новое состояние компонента, определяя минимальный набор изменений, который нужно внести в пользовательский интерфейс.

### **Как работает Reconciliation?**

1. **Обновление состояния**

- Когда меняется `state` или `props`, React запускает процесс Reconciliation.
- Он **создаёт новое Virtual DOM-дерево** для текущего состояния.

2. **Сравнение элементов (Diffing Algorithm)**

- React **построчно сравнивает новый Virtual DOM со старым**.
- Если элемент **не изменился**, он остаётся нетронутым.
- Если изменился текст или пропсы – React **обновляет только нужную часть**.
- Если элемент **удалён или добавлен**, React пересоздаёт его.

3. **Обновление реального DOM**

- React находит **разницу (diff)** между старыми и новыми элементами.
- Обновляет **только изменённые части DOM**, избегая ненужных ререндеров.

Вывод: Reconciliation делает React молниеносным, потому что он не перерисовывает весь интерфейс, а только изменённые элементы.

### Fiber

Fiber – новый движок рендеринга, который сделал обновления плавными, предсказуемыми и суперэффективными.

## **Что изменилось с Fiber?**

#### Раньше (до Fiber)

- React **обновлял весь Virtual DOM за один проход**.
- Если обновление занимало слишком много времени – интерфейс **подвисал**.
- Нельзя было **приостанавливать или отменять** обновления – React всегда доводил их до конца.

#### Теперь (с Fiber)

- **Обновления разбиваются на части** – React может приостанавливать рендеринг и продолжать его позже.
- **Важные обновления в приоритете** – ввод в `input` и клики обновляются **раньше**, чем менее важные изменения.
- **Браузер больше не замирает** – React даёт ему **время на анимации, прокрутку и другие задачи**.

<Box type="warning" title="Важно!">
Fiber – это не замена Reconciliation, а его улучшенная версия. Они работают вместе.
- **Reconciliation** – это **процесс сравнения Virtual DOM**, который определяет, **какие элементы нужно обновить**.
- **Fiber** – это **механизм, который управляет Reconciliation** и делает его **гибким, приоритетным и более эффективным**.
</Box>
