import { CodeBlock } from "../components/CodeBlock";
import Box from "../components/Box.jsx"

# Storages (Local Storage, Session Storage, cookies)

### Local Storage

**Local Storage** — это встроенная возможность браузера хранить данные на стороне клиента. Главное его отличие от обычных переменных в коде в том, что сохранённые данные остаются на устройстве даже после закрытия браузера. Это значит, что ты можешь, например, сохранить тему сайта, язык интерфейса или данные формы, чтобы при следующем посещении пользователь увидел уже нужные настройки.

**Основные особенности:**

- **Постоянство:** Данные не удаляются при закрытии вкладки или браузера.
- **Формат "ключ-значение":** Каждое значение хранится под уникальным ключом.
- **Строковый формат:** Все данные сохраняются как строки, поэтому для хранения объектов или массивов приходится преобразовывать их в строку через `JSON.stringify`.

Основные методы работы с Local Storage:

<CodeBlock code={`// Cохранение данных под определённым ключом
localStorage.setItem('userName', 'Павел');

// Получение данных из LocalStorage
const username = localStorage.getItem('username');
console.log(username); // Вывод: JohnDoe

// Удаление конкретного элемента из LocalStorage
localStorage.removeItem('username');

// Очистка всего LocalStorage
localStorage.clear();`} language="javascript" />

Local Storage идеально подходит для хранения данных, которые:

- **Не требуют высокой безопасности:** Например, настройки интерфейса, выбранные темы, язык или небольшие данные кеша.
- **Должны сохраняться между сессиями:** Это удобно, когда хочется, чтобы пользователь при повторном заходе видел то же состояние, что и в прошлый раз.
- **Не требуют частых обновлений:** Так как операции с Local Storage выполняются синхронно, если записей станет слишком много или они будут слишком объёмными, это может повлиять на производительность.

<Box type="warning" title="Важно!">
- **Размер хранилища:** Большинство браузеров позволяют хранить около 5–10 МБ данных. Если тебе нужно хранить большие объёмы, лучше рассмотреть другие решения.
- **Синхронность:** Все операции с Local Storage выполняются синхронно, что может замедлить работу при большом объёме данных.
- **Безопасность:** Данные не шифруются автоматически, поэтому в Local Storage не стоит хранить конфиденциальную информацию.
</Box>

### Session Storage

Session Storage — это встроенная возможность браузера хранить данные на стороне клиента, но с одним важным отличием от Local Storage: данные в Session Storage живут только в рамках текущей сессии браузера. Это значит, что как только ты закроешь вкладку или окно, все сохранённые данные автоматически удаляются.

Основные методы работы с Session Storage:
<CodeBlock code={`// Сохранение данных в SessionStorage
sessionStorage.setItem('tempData', 'Временное значение');

// Получение данных из SessionStorage
const tempData = sessionStorage.getItem('tempData');
console.log(tempData); // Выведет: Временное значение

// Удаление конкретного элемента из SessionStorage
sessionStorage.removeItem('tempData');

// Очистка всего SessionStorage
sessionStorage.clear(); `} language="javascript" />

Session Storage отлично подходит для случаев, когда данные нужны только в течение текущей сессии. Вот несколько примеров:

- **Временные данные форм:** Если пользователь заполняет форму и случайно обновляет страницу, можно сохранить введённые данные до отправки.
- **Состояние интерфейса:** Хранение информации о текущей вкладке, открытых панелях или шагах в многошаговом процессе.
- **Промежуточное кэширование:** Если тебе нужно кешировать данные, которые не должны сохраняться между сессиями (например, результаты временных вычислений).

<Box type="warning" title="Важно!">
- **Временный характер:** Все данные в Session Storage удаляются, как только вкладка или окно браузера закрываются. Если тебе нужно сохранить данные дольше — используй Local Storage или серверное хранилище.
- **Формат данных:** Как и в Local Storage, данные сохраняются в виде строк. Для объектов или массивов используй `JSON.stringify` при сохранении и `JSON.parse` при извлечении.
- **Синхронность:** Все операции выполняются синхронно, поэтому для небольшого объёма данных проблем с производительностью не будет.
</Box>

### Cookies

Cookies — это небольшие текстовые файлы, которые веб-сервер отправляет браузеру. Браузер сохраняет их и при последующих запросах автоматически отправляет серверу. Это позволяет, например, отслеживать авторизацию пользователя, сохранять предпочтения или вести статистику посещений.

Работа с cookies немного отличается от работы с Local Storage или Session Storage, ведь у него нет специальных методов типа setItem или getItem. Вместо этого всё происходит через свойство document.cookie.

<CodeBlock code={`// Установка Cookies
document.cookie = "username=Павел; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/";

// Чтение Cookies
console.log(document.cookie); // Может вывести: "username=Павел; theme=dark"

// Удаление Cookies (Удалить cookie можно, установив для него дату истечения в прошлом)
document.cookie = "username=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";`} language="javascript" />

Cookies отлично подходят для случаев, когда необходимо:

- **Отслеживать сессии:** Например, хранить идентификатор пользователя для проверки его авторизации.
- **Сохранять настройки:** Например, язык или тему интерфейса, если эти данные важны для серверной логики.
- **Аналитики:** Для ведения статистики посещений и поведения пользователей.

Однако если данные не требуют постоянной отправки на сервер и могут храниться только на стороне клиента, лучше рассмотреть Local Storage или Session Storage.

<Box type="warning" title="Важно!">
- **Формат и безопасность:** Всегда учитывай, какие данные ты сохраняешь в cookies. Не стоит помещать в них конфиденциальную информацию.
- **Настройка флагов:** Используй флаги `Secure` (чтобы cookie передавались только по HTTPS) и `HttpOnly` (чтобы защитить cookie от доступа через JavaScript), если это необходимо для повышения безопасности.
- **Размер и количество:** Планируй структуру хранения данных так, чтобы не перегружать запросы лишней информацией.
</Box>

### localForage

**localForage** - это JavaScript-библиотека, разработанная Mozilla, которая предоставляет удобный асинхронный API для работы с браузерным хранилищем. Если тебе знаком стандартный localStorage, то localForage покажется ему современным аналогом. Он автоматически выбирает лучшее доступное хранилище в браузере: IndexedDB, WebSQL или, в крайнем случае, localStorage. Благодаря этому твое приложение становится быстрее и надежнее, особенно при работе с большими объемами данных.

localForage отлично подойдет, если:

- **Нужно хранить большие объемы данных:**

    Например, если ты реализуешь кеширование запросов или сохраняешь результаты сложных вычислений.

- **Важна асинхронность операций:**

    При использовании localStorage операции выполняются синхронно, что может привести к тормозам в приложении. localForage избавляет от этой проблемы.

- **Требуется кроссбраузерное решение:**

    Библиотека сама выберет лучшее хранилище, доступное в браузере пользователя, что делает твой код более универсальным и надежным.
